<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="UTF-8">
  <title>Tile AR ‚Äì –ê–≤—Ç–æ–º–∞—Ç—Å–∫–æ Floor/Wall</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
      margin-top: 50px;
    }
    #viewer {
      width: 100%;
      max-width: 800px;
      height: 600px;
      border: 1px solid #ccc;
      margin-bottom: 20px;
    }
    #ar-button {
      padding: 12px 24px;
      font-size: 18px;
      border: none;
      border-radius: 8px;
      background-color: #333;
      color: white;
      cursor: pointer;
    }
    #ar-button:hover {
      background-color: #555;
    }
  </style>
</head>
<body>

<h1>View Tile in AR (Auto Floor/Wall)</h1>

<!-- –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω model-viewer —Å–æ –¥–≤–∞—Ç–∞ –º–æ–¥–µ–ª–∞ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–Ω–∏, –Ω–æ –±–µ–∑ ar-placement –≤–æ –ø–æ—á–µ—Ç–æ–∫ -->
<model-viewer
        id="viewer"
        src="models/tile_floor.glb"
        ios-src="models/tile_floor.usdz"
        alt="Tile –∑–∞ –ø–æ–¥ –∏–ª–∏ —ï–∏–¥"
        camera-controls
        auto-rotate
        auto-rotate-delay="1s"
        camera-orbit="45deg 75deg 2.5m"
        camera-target="0m 0m 0m"
        field-of-view="50deg"
        environment-image="textures/hdri_sky_015.hdr"
        poster="textures/tile2.jpg"
        ar
        ar-modes="scene-viewer quick-look webxr"
        ar-scale="auto"
        style="width: 100%; height: 600px;"
></model-viewer>

<button id="ar-button">üì± View in AR</button>

<script>
  const viewer = document.getElementById('viewer');
  const btnAR = document.getElementById('ar-button');

  let fallbackTimer = null;
  let currentlyTrying = 'floor'; // —ò–∞ –±–µ–ª–µ–∂–∏ —Ç–µ–∫–æ–≤–Ω–∞—Ç–∞ –ø–æ—Å—Ç–∞–≤–∫–∞

  btnAR.addEventListener('click', () => {
    // 1) –ü—Ä–≤–æ –≥–æ –ø–æ—Å—Ç–∞–≤—É–≤–∞–º–µ –Ω–∞ "floor" (–ø–æ–¥)
    setToFloor();

    // 2) –ì–æ –ø–æ–≤–∏–∫—É–≤–∞–º–µ AR
    activateARSession();

    // 3) –°–µ—Ç–∏—Ä–∞—ò —Ç–∞—ò–º–µ—Ä –æ–¥ 3 —Å–µ–∫—É–Ω–¥–∏: –∞–∫–æ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç –Ω–µ —É—Å–ø–µ–µ –¥–∞ –∑–∞–∫–æ—á–∏,
    // –ø–æ 3s —ú–µ –ø—Ä–æ–±–∞–º–µ –¥–∞ –ø–æ—Å—Ç–∞–≤–∏–º–µ ‚Äûwall‚Äú
    clearTimeout(fallbackTimer);
    fallbackTimer = setTimeout(() => {
      // –î–æ–∫–æ–ª–∫—É –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç —Å—ê —É—à—Ç–µ –µ –≤–æ AR —Ä–µ–∂–∏–º –∏ –Ω–µ —É—Å–ø–µ–∞–ª –¥–∞ –∑–∞–ª–µ–ø–∏:
      // —ú–µ —Å–º–µ–Ω–∏–º–µ –Ω–∞ ‚Äûwall‚Äú –∏ —ú–µ –æ–±–Ω–æ–≤–∏–º–µ AR-—Å–µ—Å–∏—ò–∞—Ç–∞.
      setToWall();
      activateARSession();
    }, 3000);
  });

  function setToFloor() {
    currentlyTrying = 'floor';
    // –ú–µ–Ω—É–≤–∞–º–µ 3D —Ñ–∞—ò–ª–æ–≤–∏—Ç–µ –∑–∞ floor‚Äê–≤–µ—Ä–∑–∏—ò–∞
    viewer.setAttribute('src', 'models/tile_floor.glb');
    viewer.setAttribute('ios-src', 'models/tile_floor.usdz');
    // –ü–æ—Å—Ç–∞–≤—É–≤–∞–º–µ anchoring –∑–∞ –ø–æ–¥
    viewer.setAttribute('ar-placement', 'floor');
  }

  function setToWall() {
    currentlyTrying = 'wall';
    // –ú–µ–Ω—É–≤–∞–º–µ 3D —Ñ–∞—ò–ª–æ–≤–∏—Ç–µ –∑–∞ wall‚Äê–≤–µ—Ä–∑–∏—ò–∞
    viewer.setAttribute('src', 'models/tile_wall.glb');
    viewer.setAttribute('ios-src', 'models/tile_wall.usdz');
    // –ü–æ—Å—Ç–∞–≤—É–≤–∞–º–µ anchoring –∑–∞ —ï–∏–¥
    viewer.setAttribute('ar-placement', 'wall');
  }

  function activateARSession() {
    if (viewer && typeof viewer.activateAR === 'function') {
      viewer.activateAR();
    } else {
      alert("AR –Ω–µ –µ –ø–æ–¥–¥—Ä–∂–∞–Ω–æ –∏–ª–∏ –º–æ–¥–µ–ª–æ—Ç –Ω–µ –µ –≤—á—Ç–µ–Ω.");
    }
  }

  // –ò–°–ö–õ–£–ß–£–í–ê–ú–ï —Ç–∞—ò–º–µ—Ä –∞–∫–æ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç —ò–∞ –Ω–∞–ø—É—à—Ç–∏ AR —Å–µ—Å–∏—ò–∞—Ç–∞
  viewer.addEventListener('ar-status', (event) => {
    // –ö–æ–≥–∞ AR —Å–µ –∑–∞—Ç–≤–æ—Ä–∞ (na 'disabled'), –≥–∏ –±—Ä–∏—à–µ–º–µ —Å–∏—Ç–µ —Ç–∞—ò–º–µ—Ä–∏
    if (event.detail.status === 'disabled') {
      clearTimeout(fallbackTimer);
    }
  });
</script>

</body>
</html>
