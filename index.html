<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="UTF-8" />
  <title>Tile AR â€“ Auto Floor/Wall</title>
  <!-- Ð’ÐºÐ»ÑƒÑ‡ÑƒÐ²Ð°ÑšÐµ Ð½Ð° model-viewer -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
      margin-top: 50px;
    }

    /* Ð“Ð»Ð°Ð²Ð½Ð¸Ð¾Ñ‚ model-viewer Ð·Ð° AR */
    #viewer {
      width: 100%;
      max-width: 800px;
      height: 600px;
      border: 1px solid #ccc;
      margin-bottom: 40px;
    }

    /* ÐšÐ¾Ð¿Ñ‡Ðµ Ð·Ð° View in AR */
    #ar-button {
      padding: 12px 24px;
      font-size: 18px;
      border: none;
      border-radius: 8px;
      background-color: #333;
      color: white;
      cursor: pointer;
    }
    #ar-button:hover {
      background-color: #555;
    }
  </style>
</head>
<body>

<h1>View Tile in AR (Auto Floor/Wall)</h1>

<!-- 1. Ð“Ð»Ð°Ð²Ð½Ð¸Ð¾Ñ‚ model-viewer, ÐºÐ¾Ñ˜ Ñ˜Ð° Ð¾Ñ‚Ð²Ð¾Ñ€Ð° AR-ÑÐµÑÐ¸Ñ˜Ð°Ñ‚Ð° -->
<model-viewer
        id="viewer"
        src="models/tile_floor.glb"
        ios-src="models/tile_floor.usdz"
        alt="Tile Ð·Ð° Ð¿Ð¾Ð´ Ð¸Ð»Ð¸ Ñ•Ð¸Ð´"
        camera-controls
        auto-rotate
        auto-rotate-delay="1s"
        camera-orbit="45deg 75deg 2.5m"
        camera-target="0m 0m 0m"
        field-of-view="50deg"
        environment-image="textures/hdri_sky_015.hdr"
        poster="textures/tile2.jpg"
        ar
        ar-modes="scene-viewer quick-look webxr"
        ar-scale="auto"
        style="width: 100%; height: 600px;"
></model-viewer>

<!-- 2. ÐšÐ¾Ð¿Ñ‡Ðµ Ð·Ð° ÑÑ‚Ð°Ñ€Ñ‚ÑƒÐ²Ð°ÑšÐµ Ð½Ð° AR-ÑÐµÑÐ¸Ñ˜Ð°Ñ‚Ð° -->
<button id="ar-button">ðŸ“± View in AR</button>

<!-- 3. JavaScript Ð·Ð° Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚ÑÐºÐ¾ Ð¼ÐµÐ½ÑƒÐ²Ð°ÑšÐµ Ð¾Ð´ floor Ð²Ð¾ wall Ð¿Ð¾ 3 ÑÐµÐºÑƒÐ½Ð´Ð¸ -->
<script>
  const viewer = document.getElementById('viewer');
  const btnAR = document.getElementById('ar-button');

  let fallbackTimer = null;

  btnAR.addEventListener('click', () => {
    // ÐŸÑ€Ð²Ð¾ Ð³Ð¾ Ð¿Ð¾ÑÑ‚Ð°Ð²ÑƒÐ²Ð°Ð¼Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¾Ñ‚ Ð·Ð° Ñ…Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»Ð½Ð° Ð¾Ñ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ˜Ð° (Ð¿Ð¾Ð´)
    setToFloor();

    // Ð“Ð¾ Ð¿Ð¾Ð²Ð¸ÐºÑƒÐ²Ð°Ð¼Ðµ AR-ÑÐµÑÐ¸Ñ˜Ð°Ñ‚Ð°
    activateARSession();

    // ÐŸÐ¾ÑÑ‚Ð°Ð²ÑƒÐ²Ð°Ð¼Ðµ Ñ‚Ð°Ñ˜Ð¼ÐµÑ€ Ð¾Ð´ 3 ÑÐµÐºÑƒÐ½Ð´Ð¸: Ð°ÐºÐ¾ Ð½Ðµ Ðµ Ð¿Ñ€Ð¾Ð½Ð°Ñ˜Ð´ÐµÐ½Ð° Ñ…Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»Ð½Ð° Ñ€Ð°Ð¼Ð½Ð¸Ð½Ð°,
    // Ð¿Ð¾ÑÐ»Ðµ 3s ÑœÐµ ÑÐµ Ð¿Ñ€ÐµÑÐ¼ÐµÑ‚Ð° vertical anchoring (Ñ•Ð¸Ð´)
    clearTimeout(fallbackTimer);
    fallbackTimer = setTimeout(() => {
      setToWall();
      activateARSession();
    }, 3000);
  });

  function setToFloor() {
    // ÐŸÐ¾ÑÑ‚Ð°Ð²ÑƒÐ²Ð°ÑšÐµ Ð½Ð° Ð°Ñ€-Ñ…Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»Ð½Ð¾ + Ð¾Ð´Ð³Ð¾Ð²Ð°Ñ€Ð°Ñ‡ÐºÐ¸ Ð¼Ð¾Ð´ÐµÐ»Ð¸
    viewer.setAttribute('src',    'models/tile_floor.glb');
    viewer.setAttribute('ios-src','models/tile_floor.usdz');
    viewer.setAttribute('ar-placement', 'floor');
  }

  function setToWall() {
    // ÐŸÐ¾ÑÑ‚Ð°Ð²ÑƒÐ²Ð°ÑšÐµ Ð½Ð° Ð°Ñ€-Ð²ÐµÑ€Ñ‚Ð¸ÐºÐ°Ð»Ð½Ð¾ + Ð¾Ð´Ð³Ð¾Ð²Ð°Ñ€Ð°Ñ‡ÐºÐ¸ Ð¼Ð¾Ð´ÐµÐ»Ð¸
    viewer.setAttribute('src',    'models/tile_wall.glb');
    viewer.setAttribute('ios-src','models/tile_wall.usdz');
    viewer.setAttribute('ar-placement', 'wall');
  }

  function activateARSession() {
    if (viewer && typeof viewer.activateAR === 'function') {
      viewer.activateAR();
    } else {
      alert("AR Ð½Ðµ Ðµ Ð¿Ð¾Ð´Ð´Ñ€Ð¶Ð°Ð½Ð¾ Ð¸Ð»Ð¸ Ð¼Ð¾Ð´ÐµÐ»Ð¾Ñ‚ Ð½Ðµ Ðµ Ð²Ñ‡Ñ‚ÐµÐ½.");
    }
  }

  // Ð”Ð¾ÐºÐ¾Ð»ÐºÑƒ ÐºÐ¾Ñ€Ð¸ÑÐ½Ð¸ÐºÐ¾Ñ‚ Ñ˜Ð° Ð½Ð°Ð¿ÑƒÑˆÑ‚Ð¸ AR-ÑÐµÑÐ¸Ñ˜Ð°Ñ‚Ð°, Ð³Ð¾ Ð±Ñ€Ð¸ÑˆÐµÐ¼Ðµ Ñ‚Ð°Ñ˜Ð¼ÐµÑ€Ð¾Ñ‚
  viewer.addEventListener('ar-status', (event) => {
    if (event.detail.status === 'disabled') {
      clearTimeout(fallbackTimer);
    }
  });
</script>

</body>
</html>
